<rules
    xmlns="http://namespaces.plone.org/diazo"
    xmlns:css="http://namespaces.plone.org/diazo/css"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xi="http://www.w3.org/2001/XInclude"
    >
    <replace theme="/html/head/title" content="/html/head/title" />

    <!-- dialog boxes -->
    <theme href="dialog.html" css:if-content="#content.dialog-wrapper"/>
    <drop css:content="meta[http-equiv='X-UA-Compatible']"/>

    <rules css:if-content="#content.dialog-wrapper">
        <prepend theme="/html/head" content="/html/head/base"/>
        <after css:theme="meta[http-equiv='X-UA-Compatible']" 
            content="/html/head/link | /html/head/style | /html/head/script | /html/head/meta" />
        <replace theme="/html/body"
            content="/html/body"/>
    </rules>
    <!--    
    <notheme if-content="html/head/link[@href='/manage_page_style.css']"/>
    <notheme css:if-content="#content.dialog-wrapper"/>
    <notheme css:if-content="body.popup"/>
    -->

    <theme href="base.html" css:if-content="#visual-portal-wrapper"/>
    <prepend theme="/html/head" content="/html/head/base"/>

    <after css:theme="meta[http-equiv='X-UA-Compatible']" 
        content="/html/head/link | /html/head/style | /html/head/script | /html/head/meta" />


    <!-- search -->
    <!-- <copy css:theme="#topsearchbox" css:content="#portal-searchbox form" attributes="action"/>  -->
    
    <!-- content title -->
    <replace css:theme-children="#content-title" css:content-children="h1.documentFirstHeading" />
    
    <!-- content subtitle -->
    <replace css:theme-children="#content-description" css:content-children="#content .articleSubheadline" />

    <!-- content byline -->
    <replace css:theme-children="#content .byline .author" css:content="#content .articleByline .articleAuthor" />

    <!-- content publish date -->
    <replace css:theme-children="#content .byline time" css:content-children="#content .articleDate" />


    <!-- content body -->
    <replace css:theme-children="#story-content" css:content-children="#content #article-content" />


    <!-- topic landing page -->
    <rules css:if-not-content="#topic-slot-three">
        <drop css:theme=".topic-header" />
    </rules>    

    <!-- issue page -->
    <rules css:if-not-content="body.section-issues">
        <drop css:theme=".issue-header" />
    </rules>
    <rules css:if-content="body.section-issues">
        <replace css:theme-children=".issue-header .issue-title" css:content-children="#parent-fieldname-title" />      
    </rules>    

    <!-- voices landing page -->
    <rules css:if-not-content="body.portaltype-topic.section-blogs">
        <drop css:theme=".voices-header" />
    </rules>


    <!-- listings -->
    <rules css:if-content=".article-listing">
      <replace css:theme-children="#phone-carousel-sub" css:content=".article-listing article.phone-top-feature"/>
      <replace css:theme-children="ol.carousel-indicators" css:content="ul.carousel-indicator li" />
      <replace css:theme="#carousel-items" css:content=".article-listing .article-carousel"/> 
      <replace css:theme-children="#folder-listing-one" css:content=".article-listing article.featured, .article-listing > article.normal, .article-listing .listing-phone-only"/>
    </rules>

    <!-- drop sample html -->
    <drop css:theme="#sample-featured" />
    <drop css:theme="#folder-listing-two" />

    <!-- make all article images responsive -->
    <xsl:template css:match="article img">
      <xsl:copy>
          <xsl:attribute name="class">img-responsive</xsl:attribute>
          <xsl:copy-of select="@*" />
          <xsl:apply-templates />
      </xsl:copy>
    </xsl:template>


    <!-- only include Disqus on articles -->
    <rules css:if-not-content="body.template-article_view">
      <drop css:theme="aside.disqus" />
    </rules>  
    





</rules>    